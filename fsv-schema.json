{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://example.com/fsv-schema.json",
    "title": "FunScriptVideo (FSV) Metadata Schema",
    "type": "object",
    "additionalProperties": true,
    "required": [
        "format_version",
        "video_formats",
        "script_variants"
    ],
    "properties": {
        "format_version": {
            "type": "string",
            "description": "Schema version in MAJOR.MINOR.PATCH format.",
            "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$"
        },
        "extensions": {
            "type": "array",
            "items": {
                "type": "string"
            },
            "description": "Optional list of extension identifiers."
        },
        "tags": {
            "type": "array",
            "items": {
                "type": "string"
            },
            "default": []
        },
        "title": {
            "type": "string",
            "description": "Human-readable canonical name of the content set."
        },
        "creators": {
            "type": "object",
            "default": {
                "videos": [],
                "scripts": [],
                "subtitles": []
            },
            "properties": {
                "videos": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/creatorEntry"
                    }
                },
                "scripts": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/creatorEntry"
                    }
                },
                "subtitles": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/creatorEntry"
                    }
                }
            },
            "additionalProperties": true
        },
        "video_formats": {
            "type": "array",
            "minItems": 1,
            "items": {
                "$ref": "#/$defs/videoFormat"
            }
        },
        "script_variants": {
            "type": "array",
            "minItems": 1,
            "items": {
                "$ref": "#/$defs/scriptVariant"
            }
        },
        "subtitle_tracks": {
            "type": "array",
            "items": {
                "$ref": "#/$defs/subtitleTrack"
            },
            "default": []
        }
    },
    "$defs": {
        "absoluteUrl": {
            "type": "string",
            "pattern": "^https?://.+",
            "description": "Must be an absolute URL."
        },
        "creatorInfo": {
            "type": "object",
            "required": [
                "name"
            ],
            "properties": {
                "name": {
                    "type": "string"
                },
                "socials": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/absoluteUrl"
                    },
                    "default": []
                }
            },
            "additionalProperties": true
        },
        "creatorEntry": {
            "type": "object",
            "required": [
                "work_name",
                "source_url",
                "creator_info"
            ],
            "properties": {
                "work_name": {
                    "type": "string"
                },
                "source_url": {
                    "$ref": "#/$defs/absoluteUrl"
                },
                "creator_info": {
                    "$ref": "#/$defs/creatorInfo"
                }
            },
            "additionalProperties": true
        },
        "checksum": {
            "type": "string",
            "pattern": "^[a-z0-9-]+:[a-f0-9]+$",
            "description": "Checksum in <algorithm>:<hex> format."
        },
        "videoFormat": {
            "type": "object",
            "required": [
                "name"
            ],
            "properties": {
                "name": {
                    "type": "string",
                    "description": "Filename of the video in the archive."
                },
                "description": {
                    "type": "string"
                },
                "duration": {
                    "type": "integer",
                    "minimum": 0
                },
                "checksum": {
                    "$ref": "#/$defs/checksum"
                }
            },
            "additionalProperties": true
        },
        "scriptVariant": {
            "type": "object",
            "required": [
                "name"
            ],
            "properties": {
                "name": {
                    "type": "string",
                    "description": "Filename of the script in the archive."
                },
                "description": {
                    "type": "string"
                },
                "additional_axes": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "duration": {
                    "type": "integer",
                    "minimum": 0
                },
                "start_offset": {
                    "type": "integer",
                    "description": "Positive = skip script intro, Negative = delay script start."
                },
                "checksum": {
                    "$ref": "#/$defs/checksum"
                }
            },
            "additionalProperties": true
        },
        "subtitleTrack": {
            "type": "object",
            "required": [
                "name",
                "language"
            ],
            "properties": {
                "name": {
                    "type": "string",
                    "description": "Filename of the subtitle file."
                },
                "language": {
                    "type": "string",
                    "pattern": "^[a-z]{2}$",
                    "description": "ISO 639-1 two-letter language code."
                },
                "description": {
                    "type": "string"
                },
                "checksum": {
                    "$ref": "#/$defs/checksum"
                }
            },
            "additionalProperties": true
        }
    }
}